{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/computer/Documents/GitHub/MasseurMatch-usa/masseurmatch-nextjs/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  throw new Error(\r\n    'Missing Supabase environment variables. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.'\r\n  );\r\n}\r\n\r\n// Client-side Supabase client (for use in Client Components)\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\n// Admin client (for server-only operations with full privileges).\r\n// Returns null if the service key is not configured.\r\nexport const supabaseAdmin = supabaseServiceKey\r\n  ? createClient(supabaseUrl, supabaseServiceKey, {\r\n      auth: {\r\n        autoRefreshToken: false,\r\n        persistSession: false,\r\n      },\r\n    })\r\n  : null;\r\n\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      therapists: {\r\n        Row: {\r\n          user_id: string;\r\n          slug: string;\r\n          display_name: string;\r\n          full_name: string;\r\n          headline: string;\r\n          about: string;\r\n          city: string;\r\n          state: string;\r\n        };\r\n      };\r\n    };\r\n  };\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;AAEhE;;AAOO,MAAM,WAAW,IAAA,wNAAY,EAAC,aAAa;AAI3C,MAAM,gBAAgB,qBACzB,IAAA,wNAAY,EAAC,aAAa,oBAAoB;IAC5C,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;IAClB;AACF,KACA"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/computer/Documents/GitHub/MasseurMatch-usa/masseurmatch-nextjs/components/CityLandingPage.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { CityInfo } from '@/data/cityMap';\r\nimport { SegmentConfig } from '@/data/segmentConfig';\r\nimport { supabase } from '@/lib/supabase';\r\n\r\ntype Therapist = {\r\n  user_id: string;\r\n  slug: string;\r\n  display_name: string;\r\n  headline: string;\r\n  city: string;\r\n  state: string;\r\n  rating: number;\r\n  profile_photo?: string;\r\n  services?: string[];\r\n};\r\n\r\ntype Props = {\r\n  city: CityInfo;\r\n  segment: SegmentConfig | null;\r\n};\r\n\r\nexport default function CityLandingPage({ city, segment }: Props) {\r\n  const [therapists, setTherapists] = useState<Therapist[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    async function fetchTherapists() {\r\n      setLoading(true);\r\n\r\n      // Base query: get therapists in this city\r\n      let query = supabase\r\n        .from('therapists')\r\n        .select('user_id, slug, display_name, headline, city, state, rating, profile_photo, services')\r\n        .ilike('city', city.name) // Case-insensitive match\r\n        .eq('status', 'active')\r\n        .order('rating', { ascending: false })\r\n        .limit(50);\r\n\r\n      // If segment filter is provided, filter by service\r\n      if (segment) {\r\n        // This assumes your services column contains the segment name\r\n        // Adjust based on your actual database structure\r\n        const serviceKeyword = segment.slug.replace(/-/g, ' ');\r\n        query = query.contains('services', [serviceKeyword]);\r\n      }\r\n\r\n      const { data, error } = await query;\r\n\r\n      if (!error && data) {\r\n        setTherapists(data);\r\n      }\r\n\r\n      setLoading(false);\r\n    }\r\n\r\n    fetchTherapists();\r\n  }, [city, segment]);\r\n\r\n  return (\r\n    <div className=\"city-landing-page\">\r\n      {/* Header */}\r\n      <header className=\"header\">\r\n        <h1>\r\n          {segment\r\n            ? `${segment.slug.replace(/-/g, ' ')} in ${city.name}${city.state ? `, ${city.state}` : ''}`\r\n            : `Massage Therapists in ${city.name}${city.state ? `, ${city.state}` : ''}`}\r\n        </h1>\r\n        {segment && (\r\n          <p className=\"narrative\">{segment.narrative(city.name)}</p>\r\n        )}\r\n      </header>\r\n\r\n      {/* Stats */}\r\n      <div className=\"stats\">\r\n        <p>\r\n          {loading\r\n            ? 'Loading...'\r\n            : `Found ${therapists.length} therapist${therapists.length !== 1 ? 's' : ''}`}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Therapist Grid */}\r\n      {loading ? (\r\n        <div className=\"loading\">Loading therapists...</div>\r\n      ) : therapists.length === 0 ? (\r\n        <div className=\"no-results\">\r\n          <p>No therapists found in {city.name}{segment && ` for ${segment.slug.replace(/-/g, ' ')}`}.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"therapist-grid\">\r\n          {therapists.map((therapist) => (\r\n            <a\r\n              key={therapist.user_id}\r\n              href={`/therapist/${therapist.slug}`}\r\n              className=\"therapist-card\"\r\n            >\r\n              {therapist.profile_photo && (\r\n                <img\r\n                  src={therapist.profile_photo}\r\n                  alt={therapist.display_name}\r\n                  className=\"profile-photo\"\r\n                />\r\n              )}\r\n              <h3>{therapist.display_name}</h3>\r\n              <p className=\"headline\">{therapist.headline}</p>\r\n              <div className=\"meta\">\r\n                <span>‚≠ê {therapist.rating}</span>\r\n                <span>üìç {therapist.city}, {therapist.state}</span>\r\n              </div>\r\n              {therapist.services && therapist.services.length > 0 && (\r\n                <div className=\"services\">\r\n                  {therapist.services.slice(0, 3).map((service) => (\r\n                    <span key={service} className=\"service-badge\">\r\n                      {service}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </a>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Neighboring Cities */}\r\n      {city.neighbors && city.neighbors.length > 0 && (\r\n        <div className=\"neighbors\">\r\n          <h2>Nearby Areas</h2>\r\n          <div className=\"neighbor-links\">\r\n            {city.neighbors.map((neighborSlug) => (\r\n              <a key={neighborSlug} href={`/city/${neighborSlug}`}>\r\n                {neighborSlug.replace(/-/g, ' ')}\r\n              </a>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}