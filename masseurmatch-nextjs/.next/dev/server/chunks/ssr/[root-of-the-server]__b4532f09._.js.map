{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/computer/Documents/GitHub/MasseurMatch-usa/masseurmatch-nextjs/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  throw new Error(\r\n    'Missing Supabase environment variables. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.'\r\n  );\r\n}\r\n\r\n// Client-side Supabase client (for use in Client Components)\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\n// Admin client (for server-only operations with full privileges).\r\n// Returns null if the service key is not configured.\r\nexport const supabaseAdmin = supabaseServiceKey\r\n  ? createClient(supabaseUrl, supabaseServiceKey, {\r\n      auth: {\r\n        autoRefreshToken: false,\r\n        persistSession: false,\r\n      },\r\n    })\r\n  : null;\r\n\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      therapists: {\r\n        Row: {\r\n          user_id: string;\r\n          slug: string;\r\n          display_name: string;\r\n          full_name: string;\r\n          headline: string;\r\n          about: string;\r\n          city: string;\r\n          state: string;\r\n        };\r\n      };\r\n    };\r\n  };\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;AAEhE;;AAOO,MAAM,WAAW,IAAA,wNAAY,EAAC,aAAa;AAI3C,MAAM,gBAAgB,qBACzB,IAAA,wNAAY,EAAC,aAAa,oBAAoB;IAC5C,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;IAClB;AACF,KACA"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/computer/Documents/GitHub/MasseurMatch-usa/masseurmatch-nextjs/lib/seo.ts"],"sourcesContent":["export const SITE_URL =\r\n  process.env.NEXT_PUBLIC_SITE_URL || 'https://www.masseurmatch.com';\r\n\r\n/**\r\n * Generate absolute URL from relative path\r\n */\r\nexport function absUrl(path: string): string {\r\n  return `${SITE_URL}${path.startsWith('/') ? path : `/${path}`}`;\r\n}\r\n\r\n/**\r\n * Strip HTML tags from string\r\n */\r\nexport function stripHtml(html?: string): string {\r\n  if (!html) return '';\r\n  return html.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\r\n}\r\n\r\n/**\r\n * Truncate string to max length with ellipsis\r\n */\r\nexport function truncate(s: string, max = 160): string {\r\n  if (!s) return '';\r\n  return s.length > max ? s.slice(0, max - 1).trim() + '…' : s;\r\n}\r\n\r\n/**\r\n * Generate SEO-friendly slug from text\r\n */\r\nexport function generateSlug(...parts: (string | undefined)[]): string {\r\n  return parts\r\n    .filter(Boolean)\r\n    .join('-')\r\n    .toLowerCase()\r\n    .replace(/[^a-z0-9]+/g, '-')\r\n    .replace(/^-|-$/g, '');\r\n}\r\n\r\n/**\r\n * Format city name for display\r\n */\r\nexport function formatCity(city: string, state?: string, country?: string): string {\r\n  let result = city;\r\n  if (state) result += `, ${state}`;\r\n  if (country && country !== 'US') result += `, ${country}`;\r\n  return result;\r\n}\r\n\r\n/**\r\n * Extract first sentence from text\r\n */\r\nexport function firstSentence(text?: string): string {\r\n  if (!text) return '';\r\n  const match = text.match(/^[^.!?]+[.!?]/);\r\n  return match ? match[0].trim() : text.substring(0, 100) + '...';\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAO,MAAM,WACX,6DAAoC;AAK/B,SAAS,OAAO,IAAY;IACjC,OAAO,GAAG,WAAW,KAAK,UAAU,CAAC,OAAO,OAAO,CAAC,CAAC,EAAE,MAAM,EAAE;AACjE;AAKO,SAAS,UAAU,IAAa;IACrC,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,KAAK,OAAO,CAAC,YAAY,KAAK,OAAO,CAAC,QAAQ,KAAK,IAAI;AAChE;AAKO,SAAS,SAAS,CAAS,EAAE,MAAM,GAAG;IAC3C,IAAI,CAAC,GAAG,OAAO;IACf,OAAO,EAAE,MAAM,GAAG,MAAM,EAAE,KAAK,CAAC,GAAG,MAAM,GAAG,IAAI,KAAK,MAAM;AAC7D;AAKO,SAAS,aAAa,GAAG,KAA6B;IAC3D,OAAO,MACJ,MAAM,CAAC,SACP,IAAI,CAAC,KACL,WAAW,GACX,OAAO,CAAC,eAAe,KACvB,OAAO,CAAC,UAAU;AACvB;AAKO,SAAS,WAAW,IAAY,EAAE,KAAc,EAAE,OAAgB;IACvE,IAAI,SAAS;IACb,IAAI,OAAO,UAAU,CAAC,EAAE,EAAE,OAAO;IACjC,IAAI,WAAW,YAAY,MAAM,UAAU,CAAC,EAAE,EAAE,SAAS;IACzD,OAAO;AACT;AAKO,SAAS,cAAc,IAAa;IACzC,IAAI,CAAC,MAAM,OAAO;IAClB,MAAM,QAAQ,KAAK,KAAK,CAAC;IACzB,OAAO,QAAQ,KAAK,CAAC,EAAE,CAAC,IAAI,KAAK,KAAK,SAAS,CAAC,GAAG,OAAO;AAC5D"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/computer/Documents/GitHub/MasseurMatch-usa/masseurmatch-nextjs/components/TherapistProfile.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/masseurmatch-nextjs/components/TherapistProfile.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/masseurmatch-nextjs/components/TherapistProfile.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,kSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAuT,GACpV,qFACA","ignoreList":[0]}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/computer/Documents/GitHub/MasseurMatch-usa/masseurmatch-nextjs/components/TherapistProfile.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/masseurmatch-nextjs/components/TherapistProfile.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/masseurmatch-nextjs/components/TherapistProfile.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,kSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAmS,GAChU,iEACA","ignoreList":[0]}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/computer/Documents/GitHub/MasseurMatch-usa/masseurmatch-nextjs/app/therapist/%5Bslug%5D/page.tsx"],"sourcesContent":["import { redirect, notFound } from 'next/navigation';\r\nimport { Metadata } from 'next';\r\nimport { supabaseAdmin } from '@/lib/supabase';\r\nimport { absUrl, stripHtml, truncate } from '@/lib/seo';\r\nimport TherapistProfile from '@/components/TherapistProfile';\r\n\r\nexport const revalidate = 3600; // Revalidate every hour\r\n\r\ntype Therapist = {\r\n  user_id: string;\r\n  slug: string;\r\n  display_name: string;\r\n  full_name: string;\r\n  headline: string;\r\n  about: string;\r\n  city: string;\r\n  state: string;\r\n  services: string[];\r\n  rating: number;\r\n  phone: string;\r\n  email: string;\r\n  profile_photo?: string;\r\n  gallery?: string[];\r\n  massage_techniques?: string[];\r\n  // Add all other fields from your therapists table\r\n};\r\n\r\nasync function getTherapistBySlug(slug: string): Promise<{\r\n  therapist: Therapist | null;\r\n  canonicalSlug: string | null;\r\n}> {\r\n  // 1) Try current slug\r\n  const { data: therapist } = await supabaseAdmin\r\n    .from('therapists')\r\n    .select('*')\r\n    .eq('slug', slug)\r\n    .eq('status', 'active')\r\n    .maybeSingle();\r\n\r\n  if (therapist) {\r\n    return { therapist, canonicalSlug: therapist.slug };\r\n  }\r\n\r\n  // 2) Check slug redirects table (old slug → therapist_id)\r\n  const { data: redirect } = await supabaseAdmin\r\n    .from('therapist_slug_redirects')\r\n    .select('therapist_id, old_slug')\r\n    .eq('old_slug', slug)\r\n    .maybeSingle();\r\n\r\n  if (!redirect?.therapist_id) {\r\n    return { therapist: null, canonicalSlug: null };\r\n  }\r\n\r\n  // 3) Get therapist by ID from redirect\r\n  const { data: therapist2 } = await supabaseAdmin\r\n    .from('therapists')\r\n    .select('*')\r\n    .eq('user_id', redirect.therapist_id)\r\n    .eq('status', 'active')\r\n    .maybeSingle();\r\n\r\n  return {\r\n    therapist: therapist2,\r\n    canonicalSlug: therapist2?.slug ?? null,\r\n  };\r\n}\r\n\r\nexport async function generateMetadata({\r\n  params,\r\n}: {\r\n  params: { slug: string };\r\n}): Promise<Metadata> {\r\n  const { therapist, canonicalSlug } = await getTherapistBySlug(params.slug);\r\n\r\n  if (!therapist) {\r\n    return {\r\n      title: 'Therapist Not Found | MasseurMatch',\r\n      robots: { index: false, follow: true },\r\n    };\r\n  }\r\n\r\n  const canonicalPath = `/therapist/${canonicalSlug}`;\r\n  const url = absUrl(canonicalPath);\r\n\r\n  const title = `${therapist.display_name} – ${therapist.headline || 'Massage Therapist'} in ${therapist.city}${therapist.state ? `, ${therapist.state}` : ''} | MasseurMatch`;\r\n\r\n  const description = truncate(\r\n    stripHtml(therapist.headline || therapist.about || `Book ${therapist.display_name} in ${therapist.city}.`),\r\n    160\r\n  );\r\n\r\n  return {\r\n    title,\r\n    description,\r\n    alternates: { canonical: url },\r\n    openGraph: {\r\n      title,\r\n      description,\r\n      url,\r\n      type: 'profile',\r\n      images: therapist.profile_photo ? [therapist.profile_photo] : [],\r\n    },\r\n    twitter: {\r\n      card: 'summary_large_image',\r\n      title,\r\n      description,\r\n      images: therapist.profile_photo ? [therapist.profile_photo] : [],\r\n    },\r\n  };\r\n}\r\n\r\nexport default async function TherapistPage({\r\n  params,\r\n}: {\r\n  params: { slug: string };\r\n}) {\r\n  const { therapist, canonicalSlug } = await getTherapistBySlug(params.slug);\r\n\r\n  if (!therapist) {\r\n    notFound();\r\n  }\r\n\r\n  // Redirect to canonical slug if different\r\n  if (canonicalSlug && canonicalSlug !== params.slug) {\r\n    redirect(`/therapist/${canonicalSlug}`);\r\n  }\r\n\r\n  // Generate JSON-LD structured data\r\n  const jsonLd = {\r\n    '@context': 'https://schema.org',\r\n    '@type': 'LocalBusiness',\r\n    '@id': absUrl(`/therapist/${therapist.slug}`),\r\n    name: therapist.display_name,\r\n    description: stripHtml(therapist.about || therapist.headline),\r\n    url: absUrl(`/therapist/${therapist.slug}`),\r\n    telephone: therapist.phone,\r\n    email: therapist.email,\r\n    image: therapist.profile_photo,\r\n    priceRange: therapist.rate_60 || '$$',\r\n    address: {\r\n      '@type': 'PostalAddress',\r\n      addressLocality: therapist.city,\r\n      addressRegion: therapist.state,\r\n      addressCountry: therapist.country || 'US',\r\n    },\r\n    geo: therapist.latitude && therapist.longitude ? {\r\n      '@type': 'GeoCoordinates',\r\n      latitude: parseFloat(therapist.latitude),\r\n      longitude: parseFloat(therapist.longitude),\r\n    } : undefined,\r\n    areaServed: {\r\n      '@type': 'City',\r\n      name: therapist.city,\r\n    },\r\n    aggregateRating: therapist.rating && therapist.override_reviews_count ? {\r\n      '@type': 'AggregateRating',\r\n      ratingValue: therapist.rating,\r\n      reviewCount: therapist.override_reviews_count,\r\n      bestRating: 5,\r\n      worstRating: 1,\r\n    } : undefined,\r\n    serviceType: therapist.services,\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <script\r\n        type=\"application/ld+json\"\r\n        dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}\r\n      />\r\n      <TherapistProfile therapist={therapist} />\r\n    </>\r\n  );\r\n}\r\n\r\n// Optional: Generate static params for top therapists\r\nexport async function generateStaticParams() {\r\n  const { data: therapists } = await supabaseAdmin\r\n    .from('therapists')\r\n    .select('slug')\r\n    .eq('status', 'active')\r\n    .limit(100); // Generate top 100 at build time\r\n\r\n  return (therapists || []).map((t) => ({\r\n    slug: t.slug,\r\n  }));\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AAAA;AAEA;AACA;AACA;;;;;;AAEO,MAAM,aAAa,MAAM,wBAAwB;AAqBxD,eAAe,mBAAmB,IAAY;IAI5C,sBAAsB;IACtB,MAAM,EAAE,MAAM,SAAS,EAAE,GAAG,MAAM,0JAAa,CAC5C,IAAI,CAAC,cACL,MAAM,CAAC,KACP,EAAE,CAAC,QAAQ,MACX,EAAE,CAAC,UAAU,UACb,WAAW;IAEd,IAAI,WAAW;QACb,OAAO;YAAE;YAAW,eAAe,UAAU,IAAI;QAAC;IACpD;IAEA,0DAA0D;IAC1D,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,0JAAa,CAC3C,IAAI,CAAC,4BACL,MAAM,CAAC,0BACP,EAAE,CAAC,YAAY,MACf,WAAW;IAEd,IAAI,CAAC,UAAU,cAAc;QAC3B,OAAO;YAAE,WAAW;YAAM,eAAe;QAAK;IAChD;IAEA,uCAAuC;IACvC,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,0JAAa,CAC7C,IAAI,CAAC,cACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,SAAS,YAAY,EACnC,EAAE,CAAC,UAAU,UACb,WAAW;IAEd,OAAO;QACL,WAAW;QACX,eAAe,YAAY,QAAQ;IACrC;AACF;AAEO,eAAe,iBAAiB,EACrC,MAAM,EAGP;IACC,MAAM,EAAE,SAAS,EAAE,aAAa,EAAE,GAAG,MAAM,mBAAmB,OAAO,IAAI;IAEzE,IAAI,CAAC,WAAW;QACd,OAAO;YACL,OAAO;YACP,QAAQ;gBAAE,OAAO;gBAAO,QAAQ;YAAK;QACvC;IACF;IAEA,MAAM,gBAAgB,CAAC,WAAW,EAAE,eAAe;IACnD,MAAM,MAAM,IAAA,8IAAM,EAAC;IAEnB,MAAM,QAAQ,GAAG,UAAU,YAAY,CAAC,GAAG,EAAE,UAAU,QAAQ,IAAI,oBAAoB,IAAI,EAAE,UAAU,IAAI,GAAG,UAAU,KAAK,GAAG,CAAC,EAAE,EAAE,UAAU,KAAK,EAAE,GAAG,GAAG,eAAe,CAAC;IAE5K,MAAM,cAAc,IAAA,gJAAQ,EAC1B,IAAA,iJAAS,EAAC,UAAU,QAAQ,IAAI,UAAU,KAAK,IAAI,CAAC,KAAK,EAAE,UAAU,YAAY,CAAC,IAAI,EAAE,UAAU,IAAI,CAAC,CAAC,CAAC,GACzG;IAGF,OAAO;QACL;QACA;QACA,YAAY;YAAE,WAAW;QAAI;QAC7B,WAAW;YACT;YACA;YACA;YACA,MAAM;YACN,QAAQ,UAAU,aAAa,GAAG;gBAAC,UAAU,aAAa;aAAC,GAAG,EAAE;QAClE;QACA,SAAS;YACP,MAAM;YACN;YACA;YACA,QAAQ,UAAU,aAAa,GAAG;gBAAC,UAAU,aAAa;aAAC,GAAG,EAAE;QAClE;IACF;AACF;AAEe,eAAe,cAAc,EAC1C,MAAM,EAGP;IACC,MAAM,EAAE,SAAS,EAAE,aAAa,EAAE,GAAG,MAAM,mBAAmB,OAAO,IAAI;IAEzE,IAAI,CAAC,WAAW;QACd,IAAA,2NAAQ;IACV;IAEA,0CAA0C;IAC1C,IAAI,iBAAiB,kBAAkB,OAAO,IAAI,EAAE;QAClD,IAAA,2NAAQ,EAAC,CAAC,WAAW,EAAE,eAAe;IACxC;IAEA,mCAAmC;IACnC,MAAM,SAAS;QACb,YAAY;QACZ,SAAS;QACT,OAAO,IAAA,8IAAM,EAAC,CAAC,WAAW,EAAE,UAAU,IAAI,EAAE;QAC5C,MAAM,UAAU,YAAY;QAC5B,aAAa,IAAA,iJAAS,EAAC,UAAU,KAAK,IAAI,UAAU,QAAQ;QAC5D,KAAK,IAAA,8IAAM,EAAC,CAAC,WAAW,EAAE,UAAU,IAAI,EAAE;QAC1C,WAAW,UAAU,KAAK;QAC1B,OAAO,UAAU,KAAK;QACtB,OAAO,UAAU,aAAa;QAC9B,YAAY,UAAU,OAAO,IAAI;QACjC,SAAS;YACP,SAAS;YACT,iBAAiB,UAAU,IAAI;YAC/B,eAAe,UAAU,KAAK;YAC9B,gBAAgB,UAAU,OAAO,IAAI;QACvC;QACA,KAAK,UAAU,QAAQ,IAAI,UAAU,SAAS,GAAG;YAC/C,SAAS;YACT,UAAU,WAAW,UAAU,QAAQ;YACvC,WAAW,WAAW,UAAU,SAAS;QAC3C,IAAI;QACJ,YAAY;YACV,SAAS;YACT,MAAM,UAAU,IAAI;QACtB;QACA,iBAAiB,UAAU,MAAM,IAAI,UAAU,sBAAsB,GAAG;YACtE,SAAS;YACT,aAAa,UAAU,MAAM;YAC7B,aAAa,UAAU,sBAAsB;YAC7C,YAAY;YACZ,aAAa;QACf,IAAI;QACJ,aAAa,UAAU,QAAQ;IACjC;IAEA,qBACE;;0BACE,wQAAC;gBACC,MAAK;gBACL,yBAAyB;oBAAE,QAAQ,KAAK,SAAS,CAAC;gBAAQ;;;;;;0BAE5D,wQAAC,oKAAgB;gBAAC,WAAW;;;;;;;;AAGnC;AAGO,eAAe;IACpB,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,0JAAa,CAC7C,IAAI,CAAC,cACL,MAAM,CAAC,QACP,EAAE,CAAC,UAAU,UACb,KAAK,CAAC,MAAM,iCAAiC;IAEhD,OAAO,CAAC,cAAc,EAAE,EAAE,GAAG,CAAC,CAAC,IAAM,CAAC;YACpC,MAAM,EAAE,IAAI;QACd,CAAC;AACH"}}]
}